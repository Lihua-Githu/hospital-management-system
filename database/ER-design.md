# 社区医院门诊管理系统 E-R 图设计

## 1. 实体设计

### 1.1 患者（Patient）
- **属性**：患者ID（主键）、姓名、性别、身份证号、电话、住址、病史

### 1.2 员工（Employee）
- **属性**：工号（主键）、姓名、员工类型、科室、职称、电话、工作状态

### 1.3 科室（Department）
- **属性**：科室ID（主键）、科室名称、描述

### 1.4 诊室（ClinicRoom）
- **属性**：诊室编号（主键）、诊室名称、所属科室、状态

### 1.5 预约（Appointment）
- **属性**：预约ID（主键）、患者信息、科室、预约日期、预约时间、状态

### 1.6 就诊（Visit）
- **属性**：就诊ID（主键）、患者、科室、诊室、医生、就诊日期、诊断、处方、状态

### 1.7 费用（Billing）
- **属性**：账单ID（主键）、就诊ID、总费用、医保支付、自费金额、支付方式、支付状态

### 1.8 排班（Schedule）
- **属性**：排班ID（主键）、医生、诊室、工作日期、时间段、最大接诊人数

## 2. 联系设计

### 2.1 员工-科室（属于）
- **联系类型**：多对一（N:1）
- **说明**：多个员工属于一个科室

### 2.2 诊室-科室（属于）
- **联系类型**：多对一（N:1）
- **说明**：多个诊室属于一个科室

### 2.3 医生-排班（安排）
- **联系类型**：一对多（1:N）
- **说明**：一个医生有多个排班

### 2.4 排班-诊室（使用）
- **联系类型**：多对一（N:1）
- **说明**：多个排班可使用同一诊室

### 2.5 患者-预约（进行）
- **联系类型**：一对多（1:N）
- **说明**：一个患者可以有多个预约

### 2.6 患者-就诊（进行）
- **联系类型**：一对多（1:N）
- **说明**：一个患者可以有多次就诊

### 2.7 就诊-医生（接诊）
- **联系类型**：多对一（N:1）
- **说明**：多个就诊记录由一个医生接诊

### 2.8 就诊-费用（产生）
- **联系类型**：一对一（1:1）
- **说明**：一次就诊产生一个费用记录

## 3. 关系模式

### 3.1 第三范式（3NF）设计

所有关系模式均满足第三范式要求：
1. 每个非主属性完全依赖于主键
2. 每个非主属性不传递依赖于主键
3. 消除了冗余和更新异常

**示例关系模式**：

```
患者（患者ID, 姓名, 性别, 身份证号, 电话, 住址, 病史）
员工（工号, 姓名, 员工类型, 科室ID, 职称, 电话, 工作状态）
就诊（就诊ID, 患者ID, 科室ID, 诊室ID, 医生ID, 就诊日期, 诊断, 处方, 状态）
费用（账单ID, 就诊ID, 患者ID, 总费用, 医保支付, 自费金额, 支付方式, 支付状态）
```

## 4. 完整性约束

### 4.1 实体完整性
- 所有主键非空且唯一

### 4.2 参照完整性
- 外键约束确保引用的一致性
- 级联删除/更新策略

### 4.3 用户定义完整性
- 性别限制为：男、女、其他
- 就诊状态限制为：等待就诊、就诊中、已完成、已离院
- 费用金额必须 >= 0
- 预约时间不能早于当前时间
